# MCP æ¶æ„æ–‡æ¡£ç²¾è¯»

> åŸæ–‡ï¼šhttps://modelcontextprotocol.io/docs/learn/architecture
> ç²¾è¯»æ—¥æœŸï¼š2026-01-05

## ä¸€ã€æ–‡æ¡£ç»“æ„æ¦‚è§ˆ

è¿™ç¯‡æ–‡æ¡£å›ç­”äº†ä¸€ä¸ªæ ¸å¿ƒé—®é¢˜ï¼š**MCP æ˜¯å¦‚ä½•è®© AI åº”ç”¨ä¸å¤–éƒ¨ä¸–ç•Œè¿æ¥çš„ï¼Ÿ**

```
MCP æ¶æ„
â”œâ”€â”€ å‚ä¸è€…ï¼ˆWhoï¼‰ï¼šä¸»æœºã€å®¢æˆ·ç«¯ã€æœåŠ¡å™¨
â”œâ”€â”€ åˆ†å±‚ï¼ˆHowï¼‰ï¼šæ•°æ®å±‚ + ä¼ è¾“å±‚
â”œâ”€â”€ åŸè¯­ï¼ˆWhatï¼‰ï¼šå·¥å…·ã€èµ„æºã€æç¤º...
â””â”€â”€ ç”Ÿå‘½å‘¨æœŸï¼ˆWhenï¼‰ï¼šåˆå§‹åŒ– â†’ é€šä¿¡ â†’ ç»ˆæ­¢
```

---

## äºŒã€æ ¸å¿ƒæ¦‚å¿µæ·±åº¦è§£æ

### 1. ä¸‰ä¸ªå‚ä¸è€…çš„å…³ç³»

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              MCP Host (ä¸»æœº)                 â”‚
â”‚         å¦‚ Claude Desktop, VS Code          â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ MCP Client  â”‚  â”‚ MCP Client  â”‚  ...      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                â”‚
          â–¼                â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ MCP Server A â”‚ â”‚ MCP Server B â”‚
   â”‚   (Sentry)   â”‚ â”‚  (Database)  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å…³é”®ç†è§£**ï¼š
- **Host** æ˜¯"è€æ¿"ï¼Œç®¡ç†å¤šä¸ª Client
- **Client** æ˜¯"å‘˜å·¥"ï¼Œæ¯ä¸ªè´Ÿè´£ç»´æŠ¤ä¸€ä¸ª Server è¿æ¥
- **Server** æ˜¯"å¤–åŒ…å•†"ï¼Œæä¾›å…·ä½“èƒ½åŠ›

**æ€è€ƒé¢˜**ï¼šä¸ºä»€ä¹ˆè¦åˆ† Host å’Œ Clientï¼Œè€Œä¸æ˜¯ Host ç›´æ¥è¿ Serverï¼Ÿ

> ç­”æ¡ˆï¼šè§£è€¦ã€‚Host ä¸“æ³¨ä¸šåŠ¡é€»è¾‘ï¼ŒClient ä¸“æ³¨è¿æ¥ç®¡ç†ã€‚ä¸€ä¸ª Host å¯ä»¥åŒæ—¶è¿æ¥å¤šä¸ª Serverï¼Œæ¯ä¸ª Client ç‹¬ç«‹ç®¡ç†è‡ªå·±çš„è¿æ¥çŠ¶æ€ã€‚

---

### 2. ä¸¤å±‚æ¶æ„

| å±‚æ¬¡ | èŒè´£ | ç±»æ¯” |
|------|------|------|
| **æ•°æ®å±‚** | å®šä¹‰"è¯´ä»€ä¹ˆ" - æ¶ˆæ¯æ ¼å¼ã€è¯­ä¹‰ | è¯­è¨€ï¼ˆä¸­æ–‡/è‹±æ–‡ï¼‰ |
| **ä¼ è¾“å±‚** | å®šä¹‰"æ€ä¹ˆè¯´" - é€šé“ã€è®¤è¯ | é€šä¿¡æ–¹å¼ï¼ˆç”µè¯/é‚®ä»¶ï¼‰ |

**ä¼ è¾“å±‚çš„ä¸¤ç§æœºåˆ¶**ï¼š

| ä¼ è¾“æ–¹å¼ | é€‚ç”¨åœºæ™¯ | ç‰¹ç‚¹ |
|----------|----------|------|
| **Stdio** | æœ¬åœ°è¿›ç¨‹ | ç®€å•ã€ä½å»¶è¿Ÿã€æ— ç½‘ç»œ |
| **Streamable HTTP** | è¿œç¨‹æœåŠ¡ | æ”¯æŒ SSEã€å¯ç©¿é€é˜²ç«å¢™ |

---

### 3. å…­å¤§åŸè¯­

è¿™æ˜¯ MCP çš„"è¯æ±‡è¡¨"ï¼Œåˆ†ä¸ºæœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯ï¼š

**æœåŠ¡å™¨æä¾›çš„ï¼ˆç»™ AI ç”¨ï¼‰**ï¼š

| åŸè¯­ | ä½œç”¨ | ä¾‹å­ |
|------|------|------|
| **Tools** | å¯æ‰§è¡Œçš„å‡½æ•° | `search_database()`, `send_email()` |
| **Resources** | åªè¯»æ•°æ®æº | æ–‡ä»¶å†…å®¹ã€æ•°æ®åº“è®°å½• |
| **Prompts** | å¯å¤ç”¨æ¨¡æ¿ | ä»£ç å®¡æŸ¥æ¨¡æ¿ã€ç¿»è¯‘æ¨¡æ¿ |

**å®¢æˆ·ç«¯æä¾›çš„ï¼ˆç»™ Server ç”¨ï¼‰**ï¼š

| åŸè¯­ | ä½œç”¨ | ä¾‹å­ |
|------|------|------|
| **Sampling** | è¯·æ±‚ LLM è¡¥å…¨ | Server éœ€è¦ AI å¸®å¿™åˆ†æ |
| **Elicitation** | è¯·æ±‚ç”¨æˆ·è¾“å…¥ | Server éœ€è¦ç”¨æˆ·ç¡®è®¤ |
| **Logging** | å‘é€æ—¥å¿— | è°ƒè¯•ä¿¡æ¯ã€é”™è¯¯æŠ¥å‘Š |

**æ€è€ƒé¢˜**ï¼šä¸ºä»€ä¹ˆ Sampling æ˜¯å®¢æˆ·ç«¯åŸè¯­ï¼Ÿ

> ç­”æ¡ˆï¼šServer æœ¬èº«æ²¡æœ‰ LLM èƒ½åŠ›ï¼Œä½†æœ‰æ—¶éœ€è¦ AI è¾…åŠ©ã€‚é€šè¿‡ Samplingï¼ŒServer å¯ä»¥"å€Ÿç”¨" Host çš„ LLM èƒ½åŠ›ã€‚

---

### 4. é€šä¿¡åè®®ï¼ˆJSON-RPC 2.0ï¼‰

æ‰€æœ‰æ¶ˆæ¯éƒ½éµå¾ªè¿™ä¸ªæ ¼å¼ï¼š

```json
{
  "jsonrpc": "2.0",
  "id": 1,              // è¯·æ±‚æ ‡è¯†ï¼ˆé€šçŸ¥æ²¡æœ‰ idï¼‰
  "method": "xxx",      // æ–¹æ³•å
  "params": {}          // å‚æ•°
}
```

**ä¸‰ç§æ¶ˆæ¯ç±»å‹**ï¼š
1. **Request** - éœ€è¦å“åº”ï¼ˆæœ‰ idï¼‰
2. **Response** - å¯¹ Request çš„å›å¤
3. **Notification** - å•å‘é€šçŸ¥ï¼ˆæ—  idï¼‰

---

### 5. ç”Ÿå‘½å‘¨æœŸ

```
Client                          Server
   â”‚                               â”‚
   â”‚â”€â”€â”€â”€ initialize â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  1. å‘é€èƒ½åŠ›
   â”‚â—€â”€â”€â”€ initialize response â”€â”€â”€â”€â”€â”€â”‚  2. è¿”å›èƒ½åŠ›
   â”‚â”€â”€â”€â”€ initialized notification â–¶â”‚  3. ç¡®è®¤å°±ç»ª
   â”‚                               â”‚
   â”‚â—€â”€â”€â”€â”€ (æ­£å¸¸é€šä¿¡) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  4. å·¥ä½œé˜¶æ®µ
   â”‚                               â”‚
   â”‚â”€â”€â”€â”€ close â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  5. å…³é—­è¿æ¥
```

**å…³é”®ç‚¹**ï¼šMCP æ˜¯**æœ‰çŠ¶æ€åè®®**ï¼Œå¿…é¡»å…ˆæ¡æ‰‹å†é€šä¿¡ã€‚

---

## ä¸‰ã€å®é™…å·¥ä½œæµç¨‹

ä»¥"æŸ¥è¯¢å¤©æ°”"ä¸ºä¾‹ï¼š

```
1. ç”¨æˆ·é—®ï¼š"æ—§é‡‘å±±å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ"

2. AI åº”ç”¨æŸ¥çœ‹å·²æ³¨å†Œçš„å·¥å…·ï¼Œå‘ç°æœ‰ weather_current

3. AI å†³å®šè°ƒç”¨å·¥å…·ï¼š
   {
     "method": "tools/call",
     "params": {
       "name": "weather_current",
       "arguments": { "location": "San Francisco" }
     }
   }

4. MCP Client è·¯ç”±è¯·æ±‚åˆ°å¯¹åº”çš„ Weather Server

5. Server æ‰§è¡Œå¹¶è¿”å›ç»“æœ

6. AI æ•´åˆç»“æœå›ç­”ç”¨æˆ·
```

---

## å››ã€æ ¸å¿ƒè®¾è®¡ç†å¿µ

| ç‰¹æ€§ | è¯´æ˜ | å¥½å¤„ |
|------|------|------|
| **åŠ¨æ€æ€§** | å·¥å…·å¯çƒ­æ’æ‹” | æ— éœ€é‡å¯å³å¯æ‰©å±•èƒ½åŠ› |
| **å®æ—¶æ€§** | åŸºäºé€šçŸ¥æœºåˆ¶ | æ— éœ€è½®è¯¢ï¼ŒåŠæ—¶å“åº”å˜åŒ– |
| **è§£è€¦æ€§** | åˆ†å±‚ + åˆ†è§’è‰² | å„ç»„ä»¶ç‹¬ç«‹æ¼”è¿› |
| **æ ‡å‡†åŒ–** | JSON-RPC 2.0 | è·¨è¯­è¨€ã€æ˜“å®ç° |

---

## äº”ã€ä¸ Tool Use çš„å…³è”

| æ¦‚å¿µ | Tool Use | MCP |
|------|----------|-----|
| å·¥å…·å®šä¹‰ | åœ¨ API è°ƒç”¨æ—¶ä¼ å…¥ | Server åŠ¨æ€æä¾› |
| å·¥å…·å‘ç° | é™æ€ï¼ˆå¼€å‘æ—¶ç¡®å®šï¼‰ | åŠ¨æ€ï¼ˆè¿è¡Œæ—¶å‘ç°ï¼‰ |
| æ‰§è¡Œä½ç½® | ä½ çš„ä»£ç  | MCP Server |

**MCP çš„ä»·å€¼**ï¼šæŠŠ Tool Use ä»"ç¡¬ç¼–ç "å˜æˆ"å³æ’å³ç”¨"ã€‚

---

## å…­ã€å…³é”®è¦ç‚¹é€Ÿè®°

1. **ä¸‰è§’è‰²**ï¼šHostï¼ˆç®¡ç†ï¼‰ â†’ Clientï¼ˆè¿æ¥ï¼‰ â†’ Serverï¼ˆèƒ½åŠ›ï¼‰
2. **ä¸¤å±‚**ï¼šæ•°æ®å±‚ï¼ˆJSON-RPCï¼‰+ ä¼ è¾“å±‚ï¼ˆStdio/HTTPï¼‰
3. **å…­åŸè¯­**ï¼šToolsã€Resourcesã€Prompts | Samplingã€Elicitationã€Logging
4. **æœ‰çŠ¶æ€**ï¼šå¿…é¡» initialize â†’ work â†’ close
5. **åŠ¨æ€å‘ç°**ï¼šå·¥å…·åˆ—è¡¨å¯å®æ—¶å˜æ›´ï¼Œé€šè¿‡ notification é€šçŸ¥

---

## ğŸ“ é‡‘å¥æ‘˜å½•

> "Host æ˜¯'è€æ¿'ï¼Œç®¡ç†å¤šä¸ª Clientï¼›Client æ˜¯'å‘˜å·¥'ï¼Œè´Ÿè´£ç»´æŠ¤ Server è¿æ¥ï¼›Server æ˜¯'å¤–åŒ…å•†'ï¼Œæä¾›å…·ä½“èƒ½åŠ›ã€‚"

> "MCP çš„ä»·å€¼ï¼šæŠŠ Tool Use ä»'ç¡¬ç¼–ç 'å˜æˆ'å³æ’å³ç”¨'ã€‚"

> "åˆ†å±‚è®¾è®¡çš„ç²¾é«“ï¼šæ•°æ®å±‚å®šä¹‰'è¯´ä»€ä¹ˆ'ï¼Œä¼ è¾“å±‚å®šä¹‰'æ€ä¹ˆè¯´'ã€‚"

---

## ä¸ªäººæ€è€ƒ

{ç•™ç©ºï¼Œä¾›åç»­è¡¥å……}

---

## ğŸ“š å»¶ä¼¸é˜…è¯»

- [MCP æ¶æ„æ–‡æ¡£](https://modelcontextprotocol.io/docs/learn/architecture) - å®˜æ–¹æ¶æ„è¯´æ˜
- [MCP Server æ¦‚å¿µ](https://modelcontextprotocol.io/docs/learn/server-concepts) - æœåŠ¡å™¨ç«¯åŸè¯­è¯¦è§£
- [MCP Client æ¦‚å¿µ](https://modelcontextprotocol.io/docs/learn/client-concepts) - å®¢æˆ·ç«¯èƒ½åŠ›è¯¦è§£
- [JSON-RPC 2.0 è§„èŒƒ](https://www.jsonrpc.org/specification) - é€šä¿¡åè®®è§„èŒƒ
- [MCP TypeScript SDK](https://github.com/modelcontextprotocol/typescript-sdk) - å®˜æ–¹ SDK

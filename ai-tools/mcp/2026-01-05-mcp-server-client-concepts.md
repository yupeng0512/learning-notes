# MCP Server ä¸ Client æ¦‚å¿µç²¾è¯»

> ç²¾è¯»æ—¥æœŸï¼š2026-01-05
> åŸæ–‡é“¾æ¥ï¼š
> - https://modelcontextprotocol.io/docs/learn/server-concepts
> - https://modelcontextprotocol.io/docs/learn/client-concepts

## ä¸€ã€æ–‡æ¡£å®šä½

è¿™ä¸¤ç¯‡æ–‡æ¡£å›ç­”äº†ï¼š
- **Server æ–‡æ¡£**ï¼šMCP æœåŠ¡å™¨èƒ½æä¾›ä»€ä¹ˆèƒ½åŠ›ï¼Ÿï¼ˆä¾›ç»™ä¾§ï¼‰
- **Client æ–‡æ¡£**ï¼šMCP å®¢æˆ·ç«¯èƒ½æä¾›ä»€ä¹ˆèƒ½åŠ›ï¼Ÿï¼ˆéœ€æ±‚ä¾§ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MCP èƒ½åŠ›å…¨æ™¯å›¾                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Server æä¾›ï¼ˆç»™ AIï¼‰   â”‚   Client æä¾›ï¼ˆç»™ Serverï¼‰     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Tools    - å¯æ‰§è¡Œå‡½æ•°   â”‚  Elicitation - è¯·æ±‚ç”¨æˆ·è¾“å…¥   â”‚
â”‚  Resources - åªè¯»æ•°æ®    â”‚  Roots       - æ–‡ä»¶ç³»ç»Ÿè¾¹ç•Œ   â”‚
â”‚  Prompts  - äº¤äº’æ¨¡æ¿     â”‚  Sampling    - å€Ÿç”¨ LLM èƒ½åŠ›  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ç¬¬ä¸€éƒ¨åˆ†ï¼šServer æ¦‚å¿µæ·±åº¦è§£æ

### 1. ä¸‰å¤§æ ¸å¿ƒåŸè¯­å¯¹æ¯”

| ç»´åº¦ | Toolsï¼ˆå·¥å…·ï¼‰ | Resourcesï¼ˆèµ„æºï¼‰ | Promptsï¼ˆæç¤ºï¼‰ |
|------|--------------|------------------|----------------|
| **æœ¬è´¨** | å¯æ‰§è¡Œçš„å‡½æ•° | åªè¯»çš„æ•°æ®æº | é¢„è®¾çš„æ¨¡æ¿ |
| **æ§åˆ¶æ–¹** | æ¨¡å‹å†³å®š | åº”ç”¨ç¨‹åºå†³å®š | ç”¨æˆ·å†³å®š |
| **è¯»/å†™** | å¯è¯»å¯å†™ | åªè¯» | åªè¯» |
| **è§¦å‘æ–¹å¼** | AI è‡ªä¸»è°ƒç”¨ | åº”ç”¨è‡ªåŠ¨åŠ è½½ | ç”¨æˆ·æ˜¾å¼è°ƒç”¨ |
| **å…¸å‹åœºæ™¯** | å‘é‚®ä»¶ã€æŸ¥èˆªç­ | è¯»æ–‡æ¡£ã€æŸ¥æ—¥å† | "/plan-vacation" |

**æ€è€ƒé¢˜**ï¼šä¸ºä»€ä¹ˆè¦åŒºåˆ† Tools å’Œ Resourcesï¼Ÿ

> ç­”æ¡ˆï¼š**å®‰å…¨æ€§**ã€‚Tools å¯ä»¥äº§ç”Ÿå‰¯ä½œç”¨ï¼ˆå†™æ•°æ®åº“ã€å‘æ¶ˆæ¯ï¼‰ï¼Œéœ€è¦æ›´ä¸¥æ ¼çš„æ§åˆ¶ï¼›Resources åªè¯»ï¼Œé£é™©æ›´ä½ã€‚è¿™ç§åŒºåˆ†è®©æƒé™ç®¡ç†æ›´ç²¾ç»†ã€‚

---

### 2. Tools è¯¦è§£

**å®šä¹‰ç»“æ„**ï¼ˆJSON Schemaï¼‰ï¼š

```json
{
  "name": "searchFlights",
  "description": "æœç´¢å¯ç”¨èˆªç­",
  "inputSchema": {
    "type": "object",
    "properties": {
      "origin": { "type": "string", "description": "å‡ºå‘åŸå¸‚" },
      "destination": { "type": "string", "description": "åˆ°è¾¾åŸå¸‚" },
      "date": { "type": "string", "format": "date" }
    },
    "required": ["origin", "destination", "date"]
  }
}
```

**åè®®æ“ä½œ**ï¼š

| æ–¹æ³• | ä½œç”¨ |
|------|------|
| `tools/list` | å‘ç°å¯ç”¨å·¥å…· |
| `tools/call` | æ‰§è¡Œç‰¹å®šå·¥å…· |

**ç”¨æˆ·äº¤äº’æ¨¡å¼**ï¼š

```
ç”¨æˆ·è¯·æ±‚ â†’ AI å†³å®šç”¨å·¥å…· â†’ [å¯èƒ½éœ€è¦ç”¨æˆ·æ‰¹å‡†] â†’ æ‰§è¡Œ â†’ è¿”å›ç»“æœ
```

**å®‰å…¨æœºåˆ¶**ï¼š
- UI æ˜¾ç¤ºå¯ç”¨å·¥å…·åˆ—è¡¨
- æ•æ„Ÿæ“ä½œéœ€ç”¨æˆ·æ‰¹å‡†
- å¯é¢„æ‰¹å‡†å®‰å…¨æ“ä½œ
- æ´»åŠ¨æ—¥å¿—è®°å½•æ‰€æœ‰æ‰§è¡Œ

---

### 3. Resources è¯¦è§£

**ä¸¤ç§å‘ç°æ¨¡å¼**ï¼š

| æ¨¡å¼ | è¯´æ˜ | URI ç¤ºä¾‹ |
|------|------|----------|
| **ç›´æ¥èµ„æº** | å›ºå®š URIï¼ŒæŒ‡å‘ç‰¹å®šæ•°æ® | `calendar://events/2024` |
| **èµ„æºæ¨¡æ¿** | å¸¦å‚æ•°çš„åŠ¨æ€ URI | `travel://activities/{city}/{category}` |

**åè®®æ“ä½œ**ï¼š

| æ–¹æ³• | ä½œç”¨ |
|------|------|
| `resources/list` | åˆ—å‡ºç›´æ¥èµ„æº |
| `resources/templates/list` | å‘ç°èµ„æºæ¨¡æ¿ |
| `resources/read` | è¯»å–èµ„æºå†…å®¹ |
| `resources/subscribe` | è®¢é˜…èµ„æºå˜åŒ– |

**å‚æ•°è¡¥å…¨**ï¼š

```
è¾“å…¥: weather://forecast/Par
å»ºè®®: ["Paris", "Park City"]
```

---

### 4. Prompts è¯¦è§£

**å®šä¹‰ç»“æ„**ï¼š

```json
{
  "name": "plan-vacation",
  "title": "è§„åˆ’å‡æœŸ",
  "description": "æŒ‡å¯¼å‡æœŸè§„åˆ’è¿‡ç¨‹",
  "arguments": [
    { "name": "destination", "type": "string", "required": true },
    { "name": "duration", "type": "number", "description": "å¤©æ•°" },
    { "name": "budget", "type": "number", "required": false }
  ]
}
```

**è§¦å‘æ–¹å¼**ï¼š
- æ–œæ å‘½ä»¤ï¼š`/plan-vacation`
- å‘½ä»¤é¢æ¿
- UI æŒ‰é’®
- å³é”®èœå•

**ä¸ Tools çš„åŒºåˆ«**ï¼š

| ç»´åº¦ | Tools | Prompts |
|------|-------|---------|
| è°è§¦å‘ | AI è‡ªä¸»å†³å®š | ç”¨æˆ·æ˜¾å¼è°ƒç”¨ |
| ä½•æ—¶ç”¨ | è¿è¡Œæ—¶åŠ¨æ€ | å¼€å§‹æ—¶é€‰æ‹© |
| ä½œç”¨ | æ‰§è¡Œæ“ä½œ | å¼•å¯¼å¯¹è¯ |

---

## ç¬¬äºŒéƒ¨åˆ†ï¼šClient æ¦‚å¿µæ·±åº¦è§£æ

### 1. ä¸‰å¤§æ ¸å¿ƒèƒ½åŠ›

| èƒ½åŠ› | ä½œç”¨ | æ–¹å‘ |
|------|------|------|
| **Elicitation** | Server å‘ç”¨æˆ·è¯·æ±‚è¾“å…¥ | Server â†’ User |
| **Roots** | å®šä¹‰æ–‡ä»¶ç³»ç»Ÿè¾¹ç•Œ | Client â†’ Server |
| **Sampling** | Server å€Ÿç”¨ LLM èƒ½åŠ› | Server â†’ Client â†’ LLM |

---

### 2. Elicitationï¼ˆå¼•å¯¼ï¼‰è¯¦è§£

**åœºæ™¯**ï¼šServer æ‰§è¡Œè¿‡ç¨‹ä¸­éœ€è¦ç”¨æˆ·ç¡®è®¤æˆ–è¡¥å……ä¿¡æ¯ã€‚

**è¯·æ±‚ç»“æ„**ï¼š

```json
{
  "method": "elicitation/requestInput",
  "params": {
    "message": "è¯·ç¡®è®¤æ‚¨çš„é¢„è®¢è¯¦æƒ…ï¼š",
    "schema": {
      "type": "object",
      "properties": {
        "confirmBooking": {
          "type": "boolean",
          "description": "ç¡®è®¤é¢„è®¢ï¼ˆæœºç¥¨+é…’åº—=3000ç¾å…ƒï¼‰"
        },
        "seatPreference": {
          "type": "string",
          "enum": ["é çª—", "è¿‡é“", "æ— åå¥½"]
        }
      },
      "required": ["confirmBooking"]
    }
  }
}
```

**ç”¨æˆ·äº¤äº’**ï¼š

```
Server è¯·æ±‚ â†’ Client å±•ç¤º UI â†’ ç”¨æˆ·å¡«å†™ â†’ è¿”å›ç»™ Server
```

**å®‰å…¨åŸåˆ™**ï¼š
- æ¸…æ™°æ˜¾ç¤ºå“ªä¸ª Server åœ¨è¯¢é—®
- ç”¨æˆ·å¯æ‹’ç»æä¾›ä¿¡æ¯
- **æ°¸ä¸è¯·æ±‚å¯†ç æˆ– API å¯†é’¥**

---

### 3. Rootsï¼ˆæ ¹ç›®å½•ï¼‰è¯¦è§£

**ä½œç”¨**ï¼šå‘Šè¯‰ Server å¯ä»¥æ“ä½œå“ªäº›ç›®å½•ã€‚

**ç»“æ„**ï¼š

```json
{
  "uri": "file:///Users/agent/travel-planning",
  "name": "æ—…è¡Œè§„åˆ’å·¥ä½œåŒº"
}
```

**é‡è¦ç†è§£**ï¼š

> Roots æ˜¯**åè°ƒæœºåˆ¶**ï¼Œä¸æ˜¯**å®‰å…¨è¾¹ç•Œ**ã€‚å®ƒå¸®åŠ© Server ç†è§£å·¥ä½œèŒƒå›´ï¼Œé˜²æ­¢æ„å¤–è¡Œä¸ºï¼Œä½†ä¸èƒ½é˜»æ­¢æ¶æ„è¡Œä¸ºã€‚

**é…ç½®æ–¹å¼**ï¼š
- è‡ªåŠ¨æ£€æµ‹ï¼šç”¨æˆ·æ‰“å¼€æ–‡ä»¶å¤¹æ—¶è‡ªåŠ¨è®¾ç½®
- æ‰‹åŠ¨é…ç½®ï¼šé«˜çº§ç”¨æˆ·æŒ‡å®šå¤šä¸ªæ ¹ç›®å½•

---

### 4. Samplingï¼ˆé‡‡æ ·ï¼‰è¯¦è§£

**åœºæ™¯**ï¼šServer éœ€è¦ AI å¸®å¿™åˆ†æï¼Œä½†è‡ªå·±æ²¡æœ‰ LLMã€‚

**è¯·æ±‚ç»“æ„**ï¼š

```json
{
  "messages": [
    {
      "role": "user",
      "content": "åˆ†æè¿™äº›èˆªç­é€‰é¡¹å¹¶æ¨èæœ€ä½³é€‰æ‹©ï¼š\n[47ä¸ªèˆªç­è¯¦æƒ…]"
    }
  ],
  "modelPreferences": {
    "hints": [{"name": "claude-sonnet-4-20250514"}],
    "costPriority": 0.3,
    "speedPriority": 0.2,
    "intelligencePriority": 0.9
  },
  "systemPrompt": "æ‚¨æ˜¯æ—…è¡Œä¸“å®¶",
  "maxTokens": 1500
}
```

**å·¥ä½œæµç¨‹**ï¼š

```
Server éœ€è¦ AI åˆ†æ
    â†“
å‘é€ Sampling è¯·æ±‚ç»™ Client
    â†“
Client è°ƒç”¨ Host çš„ LLM
    â†“
è¿”å›ç»“æœç»™ Server
```

**ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡ï¼Ÿ**
- Server æ— éœ€é›†æˆæˆ–ä»˜è´¹ AI æ¨¡å‹
- Client ä¿æŒå®Œå…¨æ§åˆ¶ï¼ˆæƒé™ã€å®‰å…¨ï¼‰
- ä¸Šä¸‹æ–‡è¾¹ç•Œæ¸…æ™°

---

## ç¬¬ä¸‰éƒ¨åˆ†ï¼šå¤šæœåŠ¡å™¨åä½œç¤ºä¾‹

ä»¥"æ—…è¡Œè§„åˆ’"ä¸ºä¾‹ï¼Œå±•ç¤ºä¸‰ä¸ª Server å¦‚ä½•åä½œï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      MCP Host                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚Travel Clientâ”‚ â”‚Weather Clientâ”‚ â”‚Calendar Clientâ”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚               â”‚               â”‚
          â–¼               â–¼               â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚Travel Serverâ”‚  â”‚Weather Serverâ”‚ â”‚Calendar Serverâ”‚
   â”‚  èˆªç­ã€é…’åº—  â”‚  â”‚  å¤©æ°”é¢„æŠ¥   â”‚  â”‚  æ—¥ç¨‹ç®¡ç†   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å®Œæ•´æµç¨‹**ï¼š

1. ç”¨æˆ·è°ƒç”¨ `/plan-vacation destination=Barcelona`ï¼ˆPromptï¼‰
2. AI è¯»å–æ—¥å†èµ„æºï¼Œäº†è§£ç”¨æˆ·ç©ºé—²æ—¶é—´ï¼ˆResourceï¼‰
3. AI è°ƒç”¨èˆªç­æœç´¢å·¥å…·ï¼ˆToolï¼‰
4. AI è°ƒç”¨å¤©æ°”æŸ¥è¯¢å·¥å…·ï¼ˆToolï¼‰
5. Server è¯·æ±‚ç”¨æˆ·ç¡®è®¤é¢„è®¢ï¼ˆElicitationï¼‰
6. AI è°ƒç”¨é¢„è®¢å·¥å…·å®Œæˆé¢„è®¢ï¼ˆToolï¼‰

---

## ç¬¬å››éƒ¨åˆ†ï¼šå…³é”®è®¾è®¡åŸåˆ™

| åŸåˆ™ | Server ä½“ç° | Client ä½“ç° |
|------|-------------|-------------|
| **ç”¨æˆ·æ§åˆ¶** | Tools å¯èƒ½éœ€æ‰¹å‡† | Elicitation å¯æ‹’ç» |
| **å®‰å…¨ä¼˜å…ˆ** | åŒºåˆ†è¯»å†™æ“ä½œ | Roots é™å®šèŒƒå›´ |
| **çµæ´»æ€§** | åŠ¨æ€å·¥å…·åˆ—è¡¨ | åŠ¨æ€æ ¹ç›®å½• |
| **é€æ˜åº¦** | æ´»åŠ¨æ—¥å¿— | æ˜¾ç¤ºè¯·æ±‚æ¥æº |

---

## ç¬¬äº”éƒ¨åˆ†ï¼šé€Ÿè®°è¦ç‚¹

### Server ä¸‰åŸè¯­

1. **Tools** = å¯æ‰§è¡Œå‡½æ•°ï¼ˆæ¨¡å‹æ§åˆ¶ï¼Œå¯è¯»å†™ï¼‰
2. **Resources** = åªè¯»æ•°æ®ï¼ˆåº”ç”¨æ§åˆ¶ï¼ŒURI å¯»å€ï¼‰
3. **Prompts** = äº¤äº’æ¨¡æ¿ï¼ˆç”¨æˆ·æ§åˆ¶ï¼Œæ–œæ å‘½ä»¤ï¼‰

### Client ä¸‰èƒ½åŠ›

1. **Elicitation** = Server å‘ç”¨æˆ·è¦ä¿¡æ¯
2. **Roots** = å‘Šè¯‰ Server å¯æ“ä½œçš„ç›®å½•
3. **Sampling** = Server å€Ÿç”¨ LLM èƒ½åŠ›

### åè®®æ–¹æ³•é€ŸæŸ¥

| ç±»åˆ« | æ–¹æ³• |
|------|------|
| Tools | `tools/list`, `tools/call` |
| Resources | `resources/list`, `resources/read`, `resources/subscribe` |
| Prompts | `prompts/list`, `prompts/get` |
| Elicitation | `elicitation/requestInput` |

---

## ğŸ“ é‡‘å¥æ‘˜å½•

> "ä¸ºä»€ä¹ˆè¦åŒºåˆ† Tools å’Œ Resourcesï¼Ÿç­”æ¡ˆï¼šå®‰å…¨æ€§ã€‚Tools å¯ä»¥äº§ç”Ÿå‰¯ä½œç”¨ï¼Œéœ€è¦æ›´ä¸¥æ ¼çš„æ§åˆ¶ï¼›Resources åªè¯»ï¼Œé£é™©æ›´ä½ã€‚"

> "Roots æ˜¯åè°ƒæœºåˆ¶ï¼Œä¸æ˜¯å®‰å…¨è¾¹ç•Œâ€”â€”å®ƒå¸®åŠ© Server ç†è§£å·¥ä½œèŒƒå›´ï¼Œé˜²æ­¢æ„å¤–è¡Œä¸ºï¼Œä½†ä¸èƒ½é˜»æ­¢æ¶æ„è¡Œä¸ºã€‚"

> "Server æœ¬èº«æ²¡æœ‰ LLM èƒ½åŠ›ï¼Œä½†é€šè¿‡ Sampling å¯ä»¥'å€Ÿç”¨' Host çš„ LLM èƒ½åŠ›ã€‚"

---

## ä¸ªäººæ€è€ƒ

{ç•™ç©ºï¼Œä¾›åç»­è¡¥å……}

---

## ğŸ“š å»¶ä¼¸é˜…è¯»

- [MCP æ¶æ„æ¦‚è¿°](./2026-01-05-mcp-architecture.md) - æœ¬åœ°å…³è”ç¬”è®°
- [MCP Server æ–‡æ¡£](https://modelcontextprotocol.io/docs/learn/server-concepts) - å®˜æ–¹æœåŠ¡å™¨æ¦‚å¿µ
- [MCP Client æ–‡æ¡£](https://modelcontextprotocol.io/docs/learn/client-concepts) - å®˜æ–¹å®¢æˆ·ç«¯æ¦‚å¿µ
- [MCP åè®®è§„èŒƒ](https://modelcontextprotocol.io/docs/spec) - å®Œæ•´åè®®è§„èŒƒ
- [MCP ç¤ºä¾‹é¡¹ç›®](https://github.com/modelcontextprotocol/servers) - å®˜æ–¹ Server ç¤ºä¾‹

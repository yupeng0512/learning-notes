# æ–‡ç« åŒæ­¥åŠ©æ‰‹ (Wechatsync) - å¤šå¹³å°å†…å®¹åˆ†å‘ + MCP AI é›†æˆ

> å­¦ä¹ æ—¥æœŸï¼š2026-01-16
> æ¥æºï¼šhttps://github.com/wechatsync/Wechatsync
> åˆ†ç±»ï¼šAI å·¥å…·ä¸æ•ˆç‡

## ğŸ“– å¿«é€Ÿæ¦‚è§ˆ

| é¡¹ç›® | å†…å®¹ |
|------|------|
| **åç§°** | æ–‡ç« åŒæ­¥åŠ©æ‰‹ (Wechatsync) |
| **ç±»å‹** | å¼€æºå·¥å…·ï¼ˆChrome æ‰©å±• + MCP æœåŠ¡ï¼‰ |
| **æ ¸å¿ƒä¸»é¢˜** | å¤šå¹³å°å†…å®¹åŒæ­¥ + AI å·¥å…·é›†æˆ |
| **ç›®æ ‡ç”¨æˆ·** | è‡ªåª’ä½“å·¥ä½œè€…ã€å†…å®¹åˆ›ä½œè€…ã€æŠ€æœ¯åšä¸» |
| **æŠ€æœ¯äº®ç‚¹** | Manifest V3 å‡çº§ã€MCP åè®®æ”¯æŒã€é€‚é…å™¨æ¨¡å¼æ¶æ„ |
| **å®˜ç½‘** | wechatsync.com |

> **ä¸€å¥è¯æ€»ç»“**ï¼šå°† **æµè§ˆå™¨æ‰©å±•** ä¸ **AI å·¥å…·é“¾ (MCP)** å·§å¦™ç»“åˆï¼Œè®©è‡ªåª’ä½“å·¥ä½œè€…èƒ½å¤Ÿç”¨è‡ªç„¶è¯­è¨€æŒ‡æŒ¥ AI å®Œæˆè·¨å¹³å°å†…å®¹åˆ†å‘ã€‚

---

## ğŸ”„ æœ¬æ¬¡æ›´æ–°äº®ç‚¹

| æ›´æ–°é¡¹ | è¯´æ˜ |
|--------|------|
| **å…¨éƒ¨å¹³å°é‡æ–°é€‚é…** | æ‰€æœ‰å¹³å°é’ˆå¯¹ MV3 æ–°æ ‡å‡†é‡å†™å’Œæµ‹è¯• |
| **åŒæ­¥ä½“éªŒä¼˜åŒ–** | å¤šå¹³å°å¹¶è¡ŒåŒæ­¥ã€å¤±è´¥é‡è¯•ã€å–æ¶ˆåŒæ­¥ |
| **MCP æ”¯æŒ** | æ”¯æŒ MCP åè®®ï¼Œå¯ä¸ Claude Code ç­‰ AI å·¥å…·é›†æˆ |
| **ç•Œé¢ä¼˜åŒ–** | é‡æ–°è®¾è®¡æ“ä½œç•Œé¢ï¼Œæ›´ç®€æ´æ˜“ç”¨ |

---

## ğŸ—ºï¸ æŠ€æœ¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ–‡ç« åŒæ­¥åŠ©æ‰‹ (Wechatsync)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   WebSocket   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   stdio     â”‚
â”‚  â”‚   Chrome    â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚   MCP Server    â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚
â”‚  â”‚  Extension  â”‚              â”‚   (Node.js)     â”‚  Claude Code â”‚
â”‚  â”‚   (MV3)     â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                       â”‚                       â”‚
â”‚         â”‚                              â”‚                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    Core æ ¸å¿ƒå±‚                            â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚ â”‚
â”‚  â”‚  â”‚  çŸ¥ä¹  â”‚ â”‚  æ˜é‡‘  â”‚ â”‚ å¤´æ¡å· â”‚ â”‚  CSDN  â”‚ ...         â”‚ â”‚
â”‚  â”‚  â”‚Adapter â”‚ â”‚Adapter â”‚ â”‚Adapter â”‚ â”‚Adapter â”‚            â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Monorepo é¡¹ç›®ç»“æ„

```
Wechatsync/
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ extension/     # Chrome æ‰©å±• (MV3) - ç”¨æˆ·ç•Œé¢
â”‚   â”‚   â”œâ”€â”€ manifest.json      # MV3 é…ç½®æ¸…å•
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ adapters/      # é€‚é…å™¨ç³»ç»Ÿå…¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ background/    # Service Worker
â”‚   â”‚   â”‚   â”œâ”€â”€ content/       # å†…å®¹è„šæœ¬
â”‚   â”‚   â”‚   â”œâ”€â”€ mcp/           # MCP å®¢æˆ·ç«¯
â”‚   â”‚   â”‚   â””â”€â”€ popup/         # å¼¹çª— UI
â”‚   â”‚
â”‚   â”œâ”€â”€ mcp-server/    # MCP Server - AI é›†æˆæ¡¥æ¢
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ index.ts       # æœåŠ¡å…¥å£ (stdio/SSE)
â”‚   â”‚   â”‚   â”œâ”€â”€ server.ts      # MCP åè®®å®ç°
â”‚   â”‚   â”‚   â””â”€â”€ ws-bridge.ts   # WebSocket æ¡¥æ¥
â”‚   â”‚
â”‚   â””â”€â”€ core/          # æ ¸å¿ƒé€»è¾‘ - å¹³å°é€‚é…
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ adapters/      # é€‚é…å™¨åŸºç±» + æ³¨å†Œè¡¨
â”‚       â”‚   â”‚   â”œâ”€â”€ base.ts    # åŸºç±»
â”‚       â”‚   â”‚   â”œâ”€â”€ registry.ts # æ³¨å†Œè¡¨
â”‚       â”‚   â”‚   â””â”€â”€ platforms/ # 20+ å¹³å°é€‚é…å™¨
â”‚       â”‚   â””â”€â”€ runtime/       # è¿è¡Œæ—¶æŠ½è±¡
```

---

## ğŸ“š äº”é—®äº”ç­”ç²¾è®²

### é—®é¢˜ä¸€ï¼šä¸ºä»€ä¹ˆ Chrome åœæ­¢æ”¯æŒ MV2ï¼ŸMV3 å¸¦æ¥äº†ä»€ä¹ˆæ ¸å¿ƒå˜åŒ–ï¼Ÿ

**Manifest V2 â†’ V3** æ˜¯ Chrome æ‰©å±•å¹³å°çš„é‡å¤§æ¶æ„å‡çº§ã€‚2024 å¹´èµ·ï¼ŒChrome åœæ­¢æ”¯æŒ MV2ã€‚

| å˜åŒ–ç‚¹ | MV2 (æ—§) | MV3 (æ–°) | å½±å“ |
|--------|----------|----------|------|
| **åå°è„šæœ¬** | æŒä¹…åŒ– Background Page | Service Worker (æŒ‰éœ€å¯åŠ¨) | å†…å­˜å ç”¨å¤§å¹…é™ä½ |
| **ç½‘ç»œæ‹¦æˆª** | `webRequest` (åŠ¨æ€æ‹¦æˆª) | `declarativeNetRequest` (é™æ€è§„åˆ™) | æ€§èƒ½æå‡ï¼Œä½†çµæ´»æ€§ä¸‹é™ |
| **è¿œç¨‹ä»£ç ** | å…è®¸æ‰§è¡Œè¿œç¨‹ JS | å®Œå…¨ç¦æ­¢ | å®‰å…¨æ€§æå‡ |
| **æƒé™æ¨¡å‹** | å®½æ¾ | ä¸¥æ ¼ï¼ŒæŒ‰éœ€ç”³è¯· | ç”¨æˆ·éšç§ä¿æŠ¤ |

**ç±»æ¯”ç†è§£**ï¼šMV2 åƒ **24 å°æ—¶å€¼ç­çš„ç§˜ä¹¦**ï¼Œéšæ—¶å¾…å‘½ä½†è€—è´¹èµ„æºï¼›MV3 åƒ **æŒ‰éœ€å¬å”¤çš„ AI åŠ©æ‰‹**ï¼Œç”¨å®Œå°±ä¼‘æ¯ï¼Œæ›´èŠ‚èƒ½é«˜æ•ˆã€‚

**å…³é”®ä»£ç ç¤ºä¾‹**ï¼ˆMV3 è¯·æ±‚å¤´è§„åˆ™ï¼‰ï¼š

```typescript
// packages/core/src/adapters/platforms/zhihu.ts
private async setupHeaderRules(): Promise<void> {
  if (!this.runtime.headerRules) return
  
  // åŠ¨æ€æ·»åŠ è¯·æ±‚å¤´è§„åˆ™ï¼ˆæ¨¡æ‹Ÿ MV2 çš„ webRequest.onBeforeSendHeadersï¼‰
  const ruleId1 = await this.runtime.headerRules.add({
    urlFilter: '*://www.zhihu.com/api/*',
    headers: {
      'x-requested-with': 'fetch',  // çŸ¥ä¹éœ€è¦è¿™ä¸ª header æ‰èƒ½æ­£å¸¸è¯·æ±‚
    },
    resourceTypes: ['xmlhttprequest'],
  })
  this.headerRuleIds.push(ruleId1)
}
```

---

### é—®é¢˜äºŒï¼šæµè§ˆå™¨æ‰©å±•å¦‚ä½•å®ç°è·¨å¹³å°å†…å®¹åŒæ­¥ï¼ŸæŠ€æœ¯åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ

æ ¸å¿ƒæŠ€æœ¯æ˜¯ **é€‚é…å™¨æ¨¡å¼ (Adapter Pattern)**ï¼Œè®©ä¸€å¥—æ ¸å¿ƒé€»è¾‘èƒ½å¤Ÿé€‚é… 20+ ä¸åŒå¹³å°çš„ APIã€‚

**Step 1: è¿è¡Œæ—¶æŠ½è±¡å±‚**

```typescript
// packages/core/src/runtime/interface.ts
export interface RuntimeInterface {
  readonly type: 'extension' | 'node'  // å¯åœ¨æ‰©å±•æˆ– Node.js è¿è¡Œ
  
  fetch(url: string, options?: RequestInit): Promise<Response>
  
  cookies: {
    get(domain: string): Promise<Cookie[]>
    set(cookie: Cookie): Promise<void>
  }
  
  headerRules?: {
    add(rule: HeaderRule): Promise<string>
    remove(ruleId: string): Promise<void>
  }
}
```

**Step 2: å¹³å°é€‚é…å™¨åŸºç±»**

```typescript
// packages/core/src/adapters/base.ts
export abstract class BaseAdapter implements PlatformAdapter {
  protected runtime!: RuntimeInterface
  
  abstract checkAuth(): Promise<AuthResult>
  abstract publish(article: Article): Promise<SyncResult>
  
  // å¸¦é‡è¯•çš„è¯·æ±‚
  protected async requestWithRetry<T>(url: string, options: RequestInit = {}): Promise<T> {
    for (let i = 0; i < 3; i++) {
      try { return await this.request<T>(url, options) }
      catch { await this.delay(1000 * (i + 1)) }  // æŒ‡æ•°é€€é¿
    }
    throw new Error('Max retries exceeded')
  }
}
```

**Step 3: å…·ä½“å¹³å°å®ç°ï¼ˆçŸ¥ä¹ä¸ºä¾‹ï¼‰**

```typescript
// packages/core/src/adapters/platforms/zhihu.ts
async publish(article: Article): Promise<SyncResult> {
  // 1ï¸âƒ£ è®¾ç½®è¯·æ±‚å¤´è§„åˆ™ï¼ˆMV3 å¿…é¡»ï¼‰
  await this.setupHeaderRules()
  
  // 2ï¸âƒ£ åˆ›å»ºè‰ç¨¿
  const draftId = await this.createDraft(article.title)
  
  // 3ï¸âƒ£ å¤„ç†å›¾ç‰‡ï¼ˆä¸Šä¼ åˆ°çŸ¥ä¹å›¾åºŠï¼‰
  content = await this.processImages(content, (src) => this.uploadImageByUrl(src))
  
  // 4ï¸âƒ£ å†…å®¹è½¬æ¢ï¼ˆé€‚é…çŸ¥ä¹ Draft.js ç¼–è¾‘å™¨æ ¼å¼ï¼‰
  content = this.transformContent(content)
  
  // 5ï¸âƒ£ æ›´æ–°è‰ç¨¿å†…å®¹
  await this.updateDraft(draftId, article.title, content)
  
  return { success: true, postUrl: `https://zhuanlan.zhihu.com/p/${draftId}/edit` }
}
```

**Step 4: å¹¶è¡ŒåŒæ­¥æ§åˆ¶**

```typescript
// packages/extension/src/adapters/index.ts
const CONCURRENCY_LIMIT = 3  // æœ€å¤šåŒæ—¶ 3 ä¸ªå¹³å°

export async function syncToMultiplePlatforms(platformIds: string[], article: Article) {
  for (let i = 0; i < platformIds.length; i += CONCURRENCY_LIMIT) {
    if (signal.aborted) break  // æ”¯æŒå–æ¶ˆ
    
    const batch = platformIds.slice(i, i + CONCURRENCY_LIMIT)
    await Promise.all(batch.map(syncOne))  // å¹¶è¡ŒåŒæ­¥
  }
}
```

**ç±»æ¯”ç†è§£**ï¼šé€‚é…å™¨åƒ **ä¸‡èƒ½å……ç”µå¤´**ï¼š
- RuntimeInterface = å……ç”µå¤´çš„è¾“å‡ºæ¥å£ï¼ˆç»Ÿä¸€çš„ USB-Cï¼‰
- BaseAdapter = å……ç”µå¤´çš„æ ¸å¿ƒç”µè·¯
- ZhihuAdapter = é€‚é…ä¸­å›½æ’åº§çš„è½¬æ¢å¤´

---

### é—®é¢˜ä¸‰ï¼šMCP åè®®æ˜¯ä»€ä¹ˆï¼Ÿä¸ Claude Code é›†æˆèƒ½å¸¦æ¥ä»€ä¹ˆæ–°å·¥ä½œæµï¼Ÿ

**MCP (Model Context Protocol)** æ˜¯ Anthropic æ¨å‡ºçš„å¼€æ”¾åè®®ï¼Œè®© AI æ¨¡å‹èƒ½å¤Ÿå®‰å…¨åœ°è°ƒç”¨å¤–éƒ¨å·¥å…·ã€‚

**é€šä¿¡é“¾è·¯**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     stdio      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    WebSocket    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Claude Code â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚ MCP Server      â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚  Extension  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**MCP Server æ³¨å†Œçš„å·¥å…·**ï¼š

```typescript
// packages/mcp-server/src/index.ts
server.setRequestHandler(ListToolsRequestSchema, async () => ({
  tools: [
    {
      name: 'list_platforms',
      description: 'åˆ—å‡ºæ‰€æœ‰æ”¯æŒçš„å¹³å°åŠå…¶ç™»å½•çŠ¶æ€',
    },
    {
      name: 'sync_article',
      description: 'åŒæ­¥æ–‡ç« åˆ°æŒ‡å®šå¹³å°ï¼ˆä¿å­˜ä¸ºè‰ç¨¿ï¼‰',
      inputSchema: {
        properties: {
          platforms: { type: 'array', items: { type: 'string' } },
          title: { type: 'string' },
          markdown: { type: 'string' },  // æ”¯æŒ Markdownï¼
        },
      }
    },
  ]
}))
```

**ä¼ ç»Ÿå·¥ä½œæµ vs AI èµ‹èƒ½å·¥ä½œæµ**ï¼š

| æ­¥éª¤ | ä¼ ç»Ÿæ–¹å¼ | MCP é›†æˆæ–¹å¼ |
|------|----------|--------------| 
| å†™æ–‡ç«  | æ‰‹åŠ¨åœ¨ç¼–è¾‘å™¨å†™ | ç”¨ Claude å¸®ä½ å†™ |
| æ ¼å¼è½¬æ¢ | æ‰‹åŠ¨å¤åˆ¶åˆ°å„å¹³å°è°ƒæ•´ | Claude è‡ªåŠ¨è½¬ Markdown |
| åŒæ­¥å‘å¸ƒ | ä¸€ä¸ªä¸ªå¹³å°æ‰‹åŠ¨å‘ | `ã€Œå¸®æˆ‘åŒæ­¥åˆ°çŸ¥ä¹å’Œæ˜é‡‘ã€` |
| å›¾ç‰‡å¤„ç† | æ‰‹åŠ¨ä¸Šä¼ åˆ°å›¾åºŠ | `ã€Œä¸Šä¼ è¿™å¼ å›¾ç‰‡åˆ°å¾®åšå›¾åºŠã€` |
| çŠ¶æ€æ£€æŸ¥ | æ‰‹åŠ¨ç™»å½•å„å¹³å° | `ã€Œæ£€æŸ¥å“ªäº›å¹³å°å·²ç™»å½•ã€` |

**ä½¿ç”¨ç¤ºä¾‹**ï¼ˆåœ¨ Claude Code ä¸­ï¼‰ï¼š

```
ç”¨æˆ·ï¼šå¸®æˆ‘æŠŠè¿™ç¯‡å…³äº AI ç¼–ç¨‹çš„æ–‡ç« åŒæ­¥åˆ°çŸ¥ä¹å’Œæ˜é‡‘

Claudeï¼šå¥½çš„ï¼Œè®©æˆ‘æ£€æŸ¥å¹³å°ç™»å½•çŠ¶æ€...
[è°ƒç”¨ list_platforms]
çŸ¥ä¹: âœ… å·²ç™»å½•
æ˜é‡‘: âœ… å·²ç™»å½•

æ­£åœ¨åŒæ­¥...
[è°ƒç”¨ sync_article]
âœ… çŸ¥ä¹è‰ç¨¿å·²ä¿å­˜ï¼šhttps://zhuanlan.zhihu.com/p/xxx/edit
âœ… æ˜é‡‘è‰ç¨¿å·²ä¿å­˜ï¼šhttps://juejin.cn/editor/drafts/xxx
```

---

### é—®é¢˜å››ï¼šå¤šå¹³å°å¹¶è¡ŒåŒæ­¥çš„ç”¨æˆ·ä½“éªŒè®¾è®¡è¦ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ

**1. çŠ¶æ€æœºè®¾è®¡**

```
starting â”€â”€â–º uploading_images â”€â”€â–º saving â”€â”€â–º completed
    â”‚              â”‚                â”‚              
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â–º failed
```

**2. è¿›åº¦ç²’åº¦æ§åˆ¶**

```typescript
export interface SyncDetailProgress {
  platform: string
  platformName: string
  stage: 'starting' | 'uploading_images' | 'saving' | 'completed' | 'failed'
  imageProgress?: { current: number; total: number }
  result?: SyncResult
  error?: string
}
```

**3. å–æ¶ˆæœºåˆ¶**

```typescript
let syncAbortController: AbortController | null = null

export function cancelSync(): boolean {
  if (syncAbortController) {
    syncAbortController.abort()
    return true
  }
  return false
}
```

**4. è®¤è¯ç¼“å­˜ç­–ç•¥**

```typescript
const AUTH_CACHE_TTL_AUTHENTICATED = 5 * 60 * 1000   // å·²ç™»å½•ï¼š5 åˆ†é’Ÿ
const AUTH_CACHE_TTL_UNAUTHENTICATED = 30 * 1000     // æœªç™»å½•ï¼š30 ç§’
```

---

### é—®é¢˜äº”ï¼šè¿™ä¸ªé¡¹ç›®çš„å•†ä¸šæ¨¡å¼å’Œå¯æŒç»­å‘å±•è·¯å¾„æ˜¯ä»€ä¹ˆï¼Ÿ

**å¯èƒ½çš„å•†ä¸šæ¨¡å¼**ï¼š

**1. Open Core æ¨¡å¼**

```
å…è´¹å±‚ï¼šåŸºç¡€åŒæ­¥ + 5 ä¸ªä¸»æµå¹³å°
ä»˜è´¹å±‚ï¼šæ‰€æœ‰ 20+ å¹³å° + å®šæ—¶åŒæ­¥ + æ•°æ®ç»Ÿè®¡
```

**2. MCP ç”Ÿæ€é›†æˆ**

```
Claude Code ç”¨æˆ· â†’ ä½¿ç”¨ MCP åŒæ­¥ â†’ æŒ‰è°ƒç”¨æ¬¡æ•°ä»˜è´¹
ä¼ä¸šç‰ˆï¼šæ— é™è°ƒç”¨ + SLA ä¿éšœ
```

**3. B2B ä¼ä¸šç‰ˆ**

```
ç›®æ ‡å®¢æˆ·ï¼šMCN æœºæ„ã€ä¼ä¸šè‡ªåª’ä½“å›¢é˜Ÿ
åŠŸèƒ½ï¼šå›¢é˜Ÿè´¦å·ç®¡ç† + å†…å®¹å®¡æ ¸æµç¨‹ + å¤šè´¦å·åŒæ­¥
```

**å¯¹å¼€å‘è€…çš„å¯ç¤º**ï¼š

- **æ¶æ„å‰ç»æ€§**ï¼šMonorepo è®© core å¯å¤ç”¨ï¼Œè½»æ¾æ‰©å±•åˆ° Firefoxã€Electron
- **é€‚é…å™¨æ¨¡å¼**ï¼šæ–°å¢å¹³å°åªéœ€å®ç°é€‚é…å™¨ï¼Œæ— éœ€ä¿®æ”¹æ ¸å¿ƒä»£ç 
- **MCP æˆ˜ç•¥æ„ä¹‰**ï¼šæ—©æœŸæ”¯æŒæ ‡å‡†åè®®ï¼Œè·å¾— AI å·¥å…·ç”Ÿæ€æµé‡

---

## ğŸ“‹ æ”¯æŒçš„å¹³å°

| ç±»å‹ | å¹³å° |
|------|------|
| **è‡ªåª’ä½“** | çŸ¥ä¹ã€å¾®åšã€å¤´æ¡å·ã€ç™¾å®¶å·ã€å¤§é±¼å·ã€æœç‹å· |
| **åˆ›ä½œç¤¾åŒº** | ç®€ä¹¦ã€å“”å“©å“”å“©ä¸“æ ã€è±†ç“£ã€é›ªçƒã€äººäººéƒ½æ˜¯äº§å“ç»ç† |
| **æŠ€æœ¯ç¤¾åŒº** | æ˜é‡‘ã€CSDNã€è¯­é›€ |
| **è‡ªå»ºåšå®¢** | WordPressã€Typechoï¼ˆMetaWeblogï¼‰ |

---

## ğŸ’¡ æ ¸å¿ƒæ”¶è·

1. **MV3 è¿ç§»æ˜¯å¿…ç»ä¹‹è·¯** â€” Service Worker å–ä»£ Background Pageï¼ŒdeclarativeNetRequest å–ä»£ webRequest

2. **é€‚é…å™¨æ¨¡å¼æ˜¯è·¨å¹³å°åŒæ­¥çš„çµé­‚** â€” ä¸€å¥—æ ¸å¿ƒé€»è¾‘ + å¤šä¸ªå¹³å°é€‚é…å™¨ï¼Œé«˜å†…èšä½è€¦åˆ

3. **MCP æ˜¯ AI å·¥å…·é›†æˆçš„æ ‡å‡†åè®®** â€” stdio/SSE åŒæ¨¡å¼ï¼Œè®© AI èƒ½å¤Ÿã€ŒåŠ¨æ‰‹åšäº‹ã€

4. **UX è®¾è®¡ä¸‰è¦ç´ ** â€” è¿›åº¦å¯è§ã€å¯å–æ¶ˆã€å¤±è´¥å¯é‡è¯•

5. **å¼€æºé¡¹ç›®å•†ä¸šåŒ–è·¯å¾„** â€” Open Core + ä¼ä¸šç‰ˆ + ç”Ÿæ€é›†æˆ

---

## âœ… è¡ŒåŠ¨æ¸…å•

### ç«‹å³å¯åš

- [ ] å®‰è£… Wechatsync æ‰©å±•ï¼Œä½“éªŒä¸€é”®åŒæ­¥
- [ ] ç™»å½• 2-3 ä¸ªå¸¸ç”¨å¹³å°ï¼Œæµ‹è¯•åŒæ­¥æ•ˆæœ

### çŸ­æœŸå®è·µ

- [ ] é…ç½® MCP Serverï¼Œä¸ Claude Code é›†æˆ
- [ ] ç”¨è‡ªç„¶è¯­è¨€å®Œæˆä¸€æ¬¡å®Œæ•´çš„å¤šå¹³å°å‘å¸ƒ
- [ ] é˜…è¯» `packages/core/src/adapters/platforms/zhihu.ts`ï¼Œç†è§£é€‚é…å™¨å®ç°

### é•¿æœŸæå‡

- [ ] Fork é¡¹ç›®ï¼Œå°è¯•è´¡çŒ®ä¸€ä¸ªæ–°å¹³å°é€‚é…å™¨
- [ ] å­¦ä¹  MCP åè®®ï¼Œäº†è§£ AI å·¥å…·é›†æˆæœ€ä½³å®è·µ

---

## ğŸ“š å»¶ä¼¸é˜…è¯»

- [Chrome Extension MV3 Migration Guide](https://developer.chrome.com/docs/extensions/mv3/intro/mv3-migration/)
- [MCP Protocol Specification](https://modelcontextprotocol.io/)
- [Adapter Design Pattern](https://refactoring.guru/design-patterns/adapter)

---

## ğŸ·ï¸ æ ‡ç­¾

#è‡ªåª’ä½“å·¥å…· #Chromeæ‰©å±• #MCPåè®® #å†…å®¹åˆ†å‘ #é€‚é…å™¨æ¨¡å¼ #ManifestV3
